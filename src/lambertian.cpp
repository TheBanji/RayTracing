////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "lambertian.hpp"
#include "sphere.hpp"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

Lambertian::Lambertian(Texture * texture) : _texture(texture) {} //const Color& albedo) : _albedo(albedo) {}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

bool Lambertian::scatter(const Ray& shotRay, const Point& intersectionPoint, const Vector& normalVector, Ray& scatteredRay, Color& attenuation, const Point& sphereCenter, double sphereRadius) const {
    double u, v;
    Sphere::uv_projection((1/sphereRadius)*(intersectionPoint-sphereCenter), u, v);
    Vector scatteredRayDir = normalVector + Sphere::random_point(0.5);
    scatteredRay           = Ray(intersectionPoint, scatteredRayDir);
    attenuation            = (*_texture)(u, v, intersectionPoint);//_albedo;
    return true;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////